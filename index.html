<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tabungan & Pengeluaran Bulanan</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
    /* Reset & Font */
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
    body { background: #f0f2f5; transition: background 0.3s, color 0.3s; }

    /* Mode Gelap */
    body.dark-mode { background: #121212; color: #e0e0e0; }
    body.dark-mode table th { background: #1f1f1f; color: #e0e0e0; }
    body.dark-mode input, body.dark-mode select, body.dark-mode button { background: #1f1f1f; color: #e0e0e0; border: 1px solid #555; }

    /* Login Page */
    #loginPage { display: flex; justify-content: center; align-items: center; height: 100vh; background: #4CAF50; color: white; }
    #loginBox { background: white; color: black; padding: 30px; border-radius: 10px; width: 300px; box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
    #loginBox input { width: 100%; margin-bottom: 15px; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
    #loginBox button { width: 100%; padding: 10px; background: #4CAF50; color: white; border: none; cursor: pointer; transition: 0.3s; }
    #loginBox button:hover { background: #45a049; }

    /* Header */
    header { background: #4CAF50; color: white; padding: 20px; text-align: center; }
    body.dark-mode header { background: #1f1f1f; color: #e0e0e0; }

    /* Container */
    .container { max-width: 900px; margin: 30px auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); transition: background 0.3s, color 0.3s; }
    body.dark-mode .container { background: #1f1f1f; color: #e0e0e0; }

    label { display: block; margin-top: 10px; font-weight: bold; }
    input, select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; }
    button { background: #4CAF50; color: white; margin-top: 15px; cursor: pointer; transition: 0.3s; }
    button:hover { background: #45a049; }

    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; transition: background 0.3s, color 0.3s; }
    th { background: #4CAF50; color: white; }
    .income { color: green; }
    .expense { color: red; }

    .summary { margin-top: 20px; font-size: 1.1em; font-weight: bold; }
    #toggleMode { float: right; margin-top: -40px; padding: 5px 10px; font-size: 0.9em; }

    canvas { margin-top: 30px; background: #fff; border-radius: 10px; padding: 20px; }
    body.dark-mode canvas { background: #1f1f1f; }
</style>
</head>
<body>

<!-- Halaman Login -->
<div id="loginPage">
    <div id="loginBox">
        <h2>Login</h2>
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button onclick="login()">Masuk</button>
    </div>
</div>

<!-- Halaman Aplikasi -->
<div id="app" style="display:none;">
    <header>
        <h1>Tabungan & Pengeluaran Bulanan</h1>
        <button id="toggleMode" onclick="toggleDarkMode()">Mode Gelap</button>
    </header>

    <div class="container">
        <h2>Input Data</h2>
        <label for="date">Tanggal:</label>
        <input type="date" id="date">

        <label for="type">Jenis:</label>
        <select id="type">
            <option value="tabungan">Tabungan</option>
            <option value="pengeluaran">Pengeluaran</option>
        </select>

        <label for="amount">Jumlah (Rp):</label>
        <input type="number" id="amount" placeholder="Masukkan jumlah">

        <button onclick="addTransaction()">Tambah</button>

        <h2>Riwayat Bulanan</h2>
        <table>
            <thead>
                <tr>
                    <th>Tanggal</th>
                    <th>Jenis</th>
                    <th>Jumlah (Rp)</th>
                </tr>
            </thead>
            <tbody id="transactionTable"></tbody>
        </table>

        <div class="summary">
            Total Tabungan: <span id="totalIncome">Rp 0</span><br>
            Total Pengeluaran: <span id="totalExpense">Rp 0</span><br>
            Saldo Akhir: <span id="balance">Rp 0</span>
        </div>

        <h2>Grafik Bulanan</h2>
        <canvas id="myChart" width="400" height="200"></canvas>
    </div>
</div>

<script>
    let transactions = [];
    let chart;

    function login() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        // Demo sederhana (username: admin, password: 1234)
        if(username === 'admin' && password === '1234'){
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('app').style.display = 'block';
        } else {
            alert('Username atau password salah!');
        }
    }

    function addTransaction() {
        const date = document.getElementById('date').value;
        const type = document.getElementById('type').value;
        const amount = parseInt(document.getElementById('amount').value);

        if (!date || !amount || amount <= 0) {
            alert("Tanggal dan jumlah harus valid!");
            return;
        }

        transactions.push({ date, type, amount });
        updateTable();
        updateSummary();
        updateChart();

        document.getElementById('date').value = '';
        document.getElementById('amount').value = '';
    }

    function updateTable() {
        const table = document.getElementById('transactionTable');
        table.innerHTML = '';
        transactions.forEach(trx => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${trx.date}</td>
                <td class="${trx.type === 'tabungan' ? 'income' : 'expense'}">${trx.type}</td>
                <td>${trx.amount.toLocaleString()}</td>
            `;
            table.appendChild(row);
        });
    }

    function updateSummary() {
        let totalIncome = 0;
        let totalExpense = 0;

        transactions.forEach(trx => {
            if(trx.type === 'tabungan') totalIncome += trx.amount;
            else totalExpense += trx.amount;
        });

        document.getElementById('totalIncome').innerText = 'Rp ' + totalIncome.toLocaleString();
        document.getElementById('totalExpense').innerText = 'Rp ' + totalExpense.toLocaleString();
        document.getElementById('balance').innerText = 'Rp ' + (totalIncome - totalExpense).toLocaleString();
    }

    function updateChart() {
        // Hitung total per tanggal
        const labels = [];
        const incomeData = [];
        const expenseData = [];

        const grouped = {};

        transactions.forEach(trx => {
            if(!grouped[trx.date]) grouped[trx.date] = { income:0, expense:0 };
            if(trx.type === 'tabungan') grouped[trx.date].income += trx.amount;
            else grouped[trx.date].expense += trx.amount;
        });

        Object.keys(grouped).sort().forEach(date => {
            labels.push(date);
            incomeData.push(grouped[date].income);
            expenseData.push(grouped[date].expense);
        });

        if(chart) chart.destroy();

        const ctx = document.getElementById('myChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    { label: 'Tabungan', data: incomeData, backgroundColor: 'green' },
                    { label: 'Pengeluaran', data: expenseData, backgroundColor: 'red' }
                ]
            },
            options: { responsive: true, plugins: { legend: { position: 'top' } } }
        });
    }

    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
    }
</script>

</body>
</html>
